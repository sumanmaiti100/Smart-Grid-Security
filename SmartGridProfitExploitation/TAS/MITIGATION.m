clear all;
format long

% Define the data with 1000 elements (as an example, you can replace these arrays with your actual data)
ScheduledGenerationMW_Actual = [685.452260000000,681.177740000000,677.898430000000,667.819470000000,668.362920000000,662.900730000000,662.929110000000,649.688550000000,642.592380000000,642.731770000000,650.563280000000,641.164480000000,639.772650000000,641.400930000000,617.448290000000,608.891990000000,647.899170000000,638.900000000000,637.820000000000,633.900000000000,624.040000000000,603.597930000000,592.315040000000,590.711760000000,584.679050000000,594.560470000000,595,577.510000000000,573.280000000000,562.870000000000,561.700000000000,565.320010000000,571.160000000000,573.790000000000,593.010000000000,622.840000000000,632.140000000000,628.260000000000,628.630000000000,631.560000000000,621.110000000000,627.490000000000,630.570000000000,629.380000000000,634.620000000000,633.703300000000,628.627560000000,624.339870000000,625.138450000000,626.035320000000,605.477270000000,619.103570000000,629.277540000000,626.405590000000,626.550210000000,630.019320000000,641.979660000000,646.335680000000,652.297460000000,644.006720000000,640.487100000000,636.805240000000,632.676340000000,642.921910000000,652.864250000000,663.368270000000,669.422370000000,674.275580000000,677.338690000000,679.978180000000,671.234800000000,677.242530000000,683.618540000000,681.758050000000,683.114620000000,690.428970000000,686.949830000000,690.644340000000,689.950930000000,691.689070000000,680.975380000000,707.855470000000,665.800850000000,702.611430000000,714.430980000000,721.870940000000,662.427400000000,648.651190000000,656.274970000000,698.376530000000,744.846950000000,806.469230000000,761.900630000000,761.897510000000,831.403070000000,852.526610000000,761.896760000000,846.904710000000,829.962910000000,886.899420000000,903.038140000000,1070.49381000000,1076.89706000000,937.828550000000,1003.87314000000,1077.00451000000,1152.82746000000,1134.76861000000,1014.48102000000,1060.30658000000,1060.40722000000,1044.03419000000,1119.83585000000,1091.06374000000,1105.80137000000,1020.42329000000,1030.28196000000,1002.54717000000,999.446420000000,906.494970000000,768.627520000000,755.403860000000,747.026530000000,732.231090000000,691.484420000000,710.613590000000,705.450260000000,835.052420000000,879.158910000000,734.864990000000,756.924250000000,747.501700000000,750.897680000000,697.351610000000,685.160050000000,706.716840000000,715.969130000000,710.014640000000,697.092790000000,693.527570000000,688.341120000000,670.363080000000,676.769710000000,679.106060000000,701.058000000000];


SemiScheduledGenerationMW_Actual = [30.8577400000000,30.5522600000000,33.8515700000000,35.5205300000000,32.9370800000000,32.6292700000000,28.6608900000000,29.7914500000000,26.6876200000000,26.0582300000000,27.5167200000000,26.8855200000000,27.6573500000000,25.2990700000000,21.9217100000000,20.0180100000000,18.5208300000000,18.3000000000000,17.9000000000000,18.5000000000000,20.6000000000000,24.2020700000000,30.0849600000000,32.8982400000000,31.3409500000000,29.1095300000000,28.5000000000000,29.2000000000000,30.7000000000000,34.4000000000000,35.2000000000000,32.2999900000000,31.4000000000000,29.8000000000000,26.1000000000000,22.1000000000000,19.7000000000000,21.1000000000000,22.1000000000000,21.8000000000000,21.3000000000000,18,17.3000000000000,17.8000000000000,17.2000000000000,15.8067000000000,17.4024400000000,18.2901300000000,18.7015500000000,16.8346800000000,17.8627300000000,19.3764300000000,20.3224600000000,20.4044100000000,18.3197900000000,17.6006800000000,18.4103400000000,17.4443200000000,17.4525400000000,17.1932800000000,19.4429000000000,19.4947600000000,20.7636600000000,18.1580900000000,20.6357500000000,22.6417300000000,21.6076300000000,22.1344200000000,23.4313100000000,24.1418200000000,23.4552000000000,21.0974700000000,20.1814600000000,23.0919500000000,21.7853800000000,20.0910300000000,25.1101700000000,24.6256600000000,27.3490700000000,31.2509300000000,32.4846200000000,29.8545300000000,32.9491500000000,34.4685700000000,35.2490200000000,35.0890600000000,39.0826000000000,43.4488100000000,42.9350300000000,42.6634700000000,40.2330500000000,41.9507700000000,43.7193700000000,46.7524900000000,42.6869300000000,46.4233900000000,52.8132400000000,53.3652900000000,56.2370900000000,57.2005800000000,50.8818600000000,57.8861900000000,52.8929400000000,49.9714500000000,47.5568600000000,44.6654900000000,47.7525400000000,44.7213900000000,37.5389800000000,38.8834200000000,38.0627800000000,43.1558100000000,48.3741500000000,44.3062600000000,44.1086300000000,43.4167100000000,43.7780400000000,60.2328300000000,67.7835800000000,76.9950300000000,76.8924800000000,70.6661400000000,74.3834700000000,82.8289100000000,83.2955800000000,70.2364100000000,73.2397400000000,76.0375800000000,81.0010900000000,77.8850100000000,78.7357500000000,72.2083000000000,62.4023200000000,61.0883900000000,74.6699500000000,66.0731600000000,58.2908700000000,65.1953600000000,89.9172100000000,109.892430000000,117.318880000000,123.286920000000,115.090290000000,112.583940000000,121.412000000000];


ScheduledDemandMW_Actual = [1194.31000000000,1189.73000000000,1187.27000000000,1181.34000000000,1179.30000000000,1173.53000000000,1169.59000000000,1157.48000000000,1147.28000000000,1146.79000000000,1145.99000000000,1146.05000000000,1145.43000000000,1144.70000000000,1117.37000000000,1106.91000000000,1141.68000000000,1132.96000000000,1133.72000000000,1130.40000000000,1122.64000000000,1105.80000000000,1100.40000000000,1101.61000000000,1094.02000000000,1101.67000000000,1101.50000000000,1084.71000000000,1081.98000000000,1072.29000000000,1071.48000000000,1042.61000000000,1080.56000000000,1081.59000000000,1097.11000000000,1122.94000000000,1129.84000000000,1127.36000000000,1128.73000000000,1131.36000000000,1120.41000000000,1123.49000000000,1125.87000000000,1125.18000000000,1129.82000000000,1127.51000000000,1124.03000000000,1120.63000000000,1121.84000000000,1120.87000000000,1101.34000000000,1116.48000000000,1127.60000000000,1124.81000000000,1122.87000000000,1125.62000000000,1138.39000000000,1141.78000000000,1147.75000000000,1139.20000000000,1137.93000000000,1134.30000000000,1131.44000000000,1139.08000000000,1151.50000000000,1164.01000000000,1169.03000000000,1174.41000000000,1178.77000000000,1182.12000000000,1172.69000000000,1176.34000000000,1181.80000000000,1182.85000000000,1182.90000000000,1188.52000000000,1190.06000000000,1193.27000000000,1195.30000000000,1200.94000000000,1191.46000000000,1191.64000000000,1163.59000000000,1166.45000000000,1174.94000000000,1185.14000000000,1162.06000000000,1170.10000000000,1166.25000000000,1173.07000000000,1172.95000000000,1179.61000000000,1174.39000000000,1184.01000000000,1189.26000000000,1207.35000000000,1207.68000000000,1213.75000000000,1195.36000000000,1213.11000000000,1224.01000000000,1231.76000000000,1248.34000000000,1256.72000000000,1257.70000000000,1264.68000000000,1271.62000000000,1268.09000000000,1264.27000000000,1275.88000000000,1247.72000000000,1220.89000000000,1242.41000000000,1245.01000000000,1253.58000000000,1263.47000000000,1267.92000000000,1271.42000000000,1266.37000000000,1265.41000000000,1249.49000000000,1247.75000000000,1254.19000000000,1251.90000000000,1252.78000000000,1258.85000000000,1256.69000000000,1254.71000000000,1257.94000000000,1258.76000000000,1238.91000000000,1242.77000000000,1247.78000000000,1222.19000000000,1223.09000000000,1250.79000000000,1252.26000000000,1253.21000000000,1265.01000000000,1281.42000000000,1283.66000000000,1271.65000000000,1269.86000000000,1269.69000000000,1300.47000000000];


ScheduleGenerationMW_Forecast_N = [634.628000000000,634.628000000000,634.628000000000,634.628000000000,634.628000000000,634.628000000000,621.687000000000,621.687000000000,621.687000000000,621.687000000000,621.687000000000,621.687000000000,620.388000000000,620.388000000000,620.388000000000,620.388000000000,620.388000000000,620.388000000000,608.833000000000,608.833000000000,608.833000000000,608.833000000000,608.833000000000,608.833000000000,613.157000000000,613.157000000000,613.157000000000,613.157000000000,613.157000000000,613.157000000000,623.529000000000,623.529000000000,623.529000000000,623.529000000000,623.529000000000,623.529000000000,634.765000000000,634.765000000000,634.765000000000,634.765000000000,634.765000000000,634.765000000000,647.772000000000,647.772000000000,647.772000000000,647.772000000000,647.772000000000,647.772000000000,655.003000000000,655.003000000000,655.003000000000,655.003000000000,655.003000000000,655.003000000000,655.420000000000,655.420000000000,655.420000000000,655.420000000000,655.420000000000,655.420000000000,656.701000000000,656.701000000000,656.701000000000,656.701000000000,656.701000000000,656.701000000000,658.563000000000,658.563000000000,658.563000000000,658.563000000000,658.563000000000,658.563000000000,665.616000000000,665.616000000000,665.616000000000,665.616000000000,665.616000000000,665.616000000000,688.150000000000,688.150000000000,688.150000000000,688.150000000000,688.150000000000,688.150000000000,729.674000000000,729.674000000000,729.674000000000,729.674000000000,729.674000000000,729.674000000000,790.788000000000,790.788000000000,790.788000000000,790.788000000000,790.788000000000,790.788000000000,846.604000000000,846.604000000000,846.604000000000,846.604000000000,846.604000000000,846.604000000000,870.064000000000,870.064000000000,870.064000000000,870.064000000000,870.064000000000,870.064000000000,876.115000000000,876.115000000000,876.115000000000,876.115000000000,876.115000000000,876.115000000000,866.876000000000,866.876000000000,866.876000000000,866.876000000000,866.876000000000,866.876000000000,854.865000000000,854.865000000000,854.865000000000,854.865000000000,854.865000000000,854.865000000000,830.926000000000,830.926000000000,830.926000000000,830.926000000000,830.926000000000,830.926000000000,805.636000000000,805.636000000000,805.636000000000,805.636000000000,805.636000000000,805.636000000000,771.092000000000,771.092000000000,771.092000000000,771.092000000000,771.092000000000,771.092000000000];


SemiScheduleGenerationMW_Forecast_N = [42.3720000000000,42.3720000000000,42.3720000000000,42.3720000000000,42.3720000000000,42.3720000000000,41.3130000000000,41.3130000000000,41.3130000000000,41.3130000000000,41.3130000000000,41.3130000000000,41.5220000000000,41.5220000000000,41.5220000000000,41.5220000000000,41.5220000000000,41.5220000000000,36.1670000000000,36.1670000000000,36.1670000000000,36.1670000000000,36.1670000000000,36.1670000000000,31.8430000000000,31.8430000000000,31.8430000000000,31.8430000000000,31.8430000000000,31.8430000000000,27.4710000000000,27.4710000000000,27.4710000000000,27.4710000000000,27.4710000000000,27.4710000000000,23.2350000000000,23.2350000000000,23.2350000000000,23.2350000000000,23.2350000000000,23.2350000000000,19.2280000000000,19.2280000000000,19.2280000000000,19.2280000000000,19.2280000000000,19.2280000000000,15.9970000000000,15.9970000000000,15.9970000000000,15.9970000000000,15.9970000000000,15.9970000000000,18.5800000000000,18.5800000000000,18.5800000000000,18.5800000000000,18.5800000000000,18.5800000000000,21.2990000000000,21.2990000000000,21.2990000000000,21.2990000000000,21.2990000000000,21.2990000000000,24.4370000000000,24.4370000000000,24.4370000000000,24.4370000000000,24.4370000000000,24.4370000000000,28.3840000000000,28.3840000000000,28.3840000000000,28.3840000000000,28.3840000000000,28.3840000000000,31.8500000000000,31.8500000000000,31.8500000000000,31.8500000000000,31.8500000000000,31.8500000000000,35.3260000000000,35.3260000000000,35.3260000000000,35.3260000000000,35.3260000000000,35.3260000000000,34.2120000000000,34.2120000000000,34.2120000000000,34.2120000000000,34.2120000000000,34.2120000000000,33.3960000000000,33.3960000000000,33.3960000000000,33.3960000000000,33.3960000000000,33.3960000000000,32.9360000000000,32.9360000000000,32.9360000000000,32.9360000000000,32.9360000000000,32.9360000000000,32.8850000000000,32.8850000000000,32.8850000000000,32.8850000000000,32.8850000000000,32.8850000000000,32.1240000000000,32.1240000000000,32.1240000000000,32.1240000000000,32.1240000000000,32.1240000000000,31.1350000000000,31.1350000000000,31.1350000000000,31.1350000000000,31.1350000000000,31.1350000000000,35.0740000000000,35.0740000000000,35.0740000000000,35.0740000000000,35.0740000000000,35.0740000000000,38.3640000000000,38.3640000000000,38.3640000000000,38.3640000000000,38.3640000000000,38.3640000000000,41.9080000000000,41.9080000000000,41.9080000000000,41.9080000000000,41.9080000000000,41.9080000000000];


NetImportMW_Actual = [-478,-478,-475.510000000000,-478,-478,-478,-478,-478,-478,-478,-467.910000000000,-478,-478,-478,-478,-478,-475.260000000000,-475.760000000000,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-475.020000000000,-474.580000000000,-444.990000000000,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478,-453.930000000000,-464.840000000000,-429.370000000000,-425.250000000000,-428.180000000000,-460.550000000000,-478,-467.040000000000,-432.040000000000,-387.870000000000,-331.180000000000,-368.770000000000,-375.360000000000,-315.170000000000,-308.400000000000,-392.970000000000,-313.490000000000,-309.160000000000,-269.010000000000,-270.090000000000,-103.370000000000,-118.540000000000,-268.920000000000,-206.270000000000,-143.020000000000,-71.0400000000000,-88.6000000000000,-212.250000000000,-176.690000000000,-149.250000000000,-133.700000000000,-74.1900000000000,-109.630000000000,-103.670000000000,-199.630000000000,-193.870000000000,-208.640000000000,-199.150000000000,-281.920000000000,-403.970000000000,-421.670000000000,-432.780000000000,-436.840000000000,-478,-478,-478,-343.610000000000,-297.780000000000,-446.010000000000,-403.250000000000,-423.070000000000,-434.470000000000,-463.760000000000,-463.250000000000,-478,-478,-478,-478,-478,-478,-478,-478,-478,-478];


NetImportMWForecast_N = [-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-429.090000000000,-429.090000000000,-429.090000000000,-429.090000000000,-429.090000000000,-429.090000000000,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441,-441];


sum = 0;

n = length(NetImportMW_Actual);

% Define the range for the uniform distribution
range = sqrt(3) * 10;  % To get a standard deviation of 10, use Â±range

% Generate uniform-distributed random numbers with a mean of 0 and standard deviation of 10
uniform_noise = -range + 2 * range * rand(1, n);  % This generates values between -range and +range

% Add the uniform noise to the original array
ScheduledDemandMW_Actual = ScheduledDemandMW_Actual + uniform_noise;

% (Rest of the code remains the same)
k = 6;
num_iterations = floor(length(ScheduledGenerationMW_Actual) / k); % Number of 6-value windows

% Initialize 2D arrays to store Lambda and b values for all iterations
Lambda_values = zeros(num_iterations, k); % Rows: iterations, Columns: 6 values
b_values = ones(num_iterations, k);      % Rows: iterations, Columns: 6 values (all set to 1)

for i = 1:num_iterations
    % Extract the current window of 6 values
    ScheduledGenerationMW_Actual_window = ScheduledGenerationMW_Actual((i-1)*k + 1:i*k);
    SemiScheduledGenerationMW_Actual_window = SemiScheduledGenerationMW_Actual((i-1)*k + 1:i*k);
    ScheduledDemandMW_Actual_window = ScheduledDemandMW_Actual((i-1)*k + 1:i*k);
    ScheduleGenerationMW_Forecast_N_window = ScheduleGenerationMW_Forecast_N((i-1)*k + 1:i*k);
    SemiScheduleGenerationMW_Forecast_N_window = SemiScheduleGenerationMW_Forecast_N((i-1)*k + 1:i*k);
    NetImportMW_Actual_window = NetImportMW_Actual((i-1)*k + 1:i*k);
    NetImportMWForecast_N_window = NetImportMWForecast_N((i-1)*k + 1:i*k);
    
    Lambda = zeros(1, k);
    b = ones(1, k); % b is set to 1 for every iteration
    
    for m = 1:k
        if m == 1
            Lambda(1,1) = 103.20626; % Initial value for Lambda
        else
            Lambda(1,m) = Lambda(1,(m-1)) * (1 - (ScheduledGenerationMW_Actual_window(1,(m-1)) + SemiScheduledGenerationMW_Actual_window(1,(m-1)) - ScheduledDemandMW_Actual_window(1,(m-1))) / (ScheduleGenerationMW_Forecast_N_window(1,(m-1)) + SemiScheduleGenerationMW_Forecast_N_window(1,(m-1)) - ScheduledDemandMW_Actual_window(1,(m-1))) + (b(1,(m-1)) * NetImportMW_Actual_window(1,(m-1))) / (NetImportMWForecast_N_window(1,(m-1))));
            
            % Apply limits and conditions
            if Lambda(1,m) <= -800
                Lambda(1,m) = -800;
            end
            if Lambda(1,m) >= 600
                Lambda(1,m) = 600;
            end
            if ((ScheduledGenerationMW_Actual_window(1,m) + SemiScheduledGenerationMW_Actual_window(1,m) - ScheduledDemandMW_Actual_window(1,m) + (NetImportMW_Actual_window(1,m)))) >= -180
                Lambda(1,m) = -1;
            end
            if ((ScheduledGenerationMW_Actual_window(1,m) + SemiScheduledGenerationMW_Actual_window(1,m) - ScheduledDemandMW_Actual_window(1,m) + (b(1,m) * NetImportMW_Actual_window(1,m)))) <= 180
                Lambda(1,m) = -1;
            end
        end
        sum = abs(sum + (Lambda(1,m)));
    end
    
    % Store the computed values of Lambda and b in the arrays
    Lambda_values(i, :) = Lambda;
    b_values(i, :) = b;  % This is always 1, but stored for completeness
end

Lambda_values_re = reshape(Lambda_values, 1, []);
b_values_re = reshape(b_values, 1, []);

for j = 1:144
    if Lambda_values_re(1,j) <= -20
        Lambda_values_re(1,j) = -20;
    end
end

for j = 1:144
    ProfitNoise(1,j) = abs((Lambda_values_re(1,j) * NetImportMW_Actual(1,j)));
end

value(sum);